#load "../tests/raylib.zen";

namespace game;

struct Player
{
	raylib::Vector2 pos;
	raylib::Color color;
}

let Player player;
const float PLAYER_SPEED = 500.0;

fun void start_game()
{
    let raylib::Color black;
	black.r = 0; black.g = 0; black.b = 0; black.a = 255;

    raylib::InitWindow(1280, 720, "Zen");
	raylib::SetTargetFPS(60);

	player.color.r = 255; player.color.g = 255; player.color.b = 0; player.color.a = 255;

	while (raylib::WindowShouldClose() == false)
	{
		raylib::BeginDrawing();
		raylib::ClearBackground(black);
		
		draw_game();

		raylib::DrawFPS(20, 20);

		raylib::EndDrawing();
	}
	raylib::CloseWindow();
}

fun void draw_game()
{
	if (raylib::IsKeyDown(raylib::KeyboardKey::LEFT))
	{
		player.pos.x -= PLAYER_SPEED * raylib::GetFrameTime();
	}
	if (raylib::IsKeyDown(raylib::KeyboardKey::RIGHT))
	{
		player.pos.x += PLAYER_SPEED * raylib::GetFrameTime();
	}
	if (raylib::IsKeyDown(raylib::KeyboardKey::UP))
	{
		player.pos.y -= PLAYER_SPEED * raylib::GetFrameTime();
	}
	if (raylib::IsKeyDown(raylib::KeyboardKey::DOWN))
	{
		player.pos.y += PLAYER_SPEED * raylib::GetFrameTime();
	}

	raylib::DrawRectangle(cast(int)player.pos.x, cast(int)player.pos.y, 32, 32, player.color);
	raylib::DrawText("pelly", cast(int)(player.pos.x - 8.0), cast(int)(player.pos.y - 24.0), 20, player.color);

	if (player.pos.x >= 400)
	{
		player.color.r = 0;
	}
	else
	{
		player.color.r = 255;
	}
}
#load "../tests/raylib.zen";
#load "../std/math.zen";
#load "player.zen";

namespace game;

fun void start_game()
{
    let raylib::Color black;
	black.r = 0; black.g = 0; black.b = 0; black.a = 255;

    raylib::InitWindow(1280, 720, "Zen");
	raylib::SetTargetFPS(60);

	let Player player;
	init_player(&player);

	while (!raylib::WindowShouldClose())
	{
		update_game(&player);

		raylib::BeginDrawing();
		raylib::ClearBackground(black);
		
		draw_game(&player);

		raylib::DrawFPS(20, 20);

		raylib::EndDrawing();
	}
	raylib::CloseWindow();
}

fun void update_game(Player* player)
{
	update_player(player);
}

fun void draw_game(Player* player)
{
	draw_player(player);

	let float sinx = math::sinf(player.time * 8.0) * 44.0;
	let float siny = math::cosf(player.time * 8.0) * 44.0;
	raylib::DrawCircle(cast(int)sinx + 400, cast(int)siny + 400, 32, player.color);

	println(sinx);
}
#load "entity.zen";
// #load "draw.zen";

namespace game;

struct Player
{
	Entity entity;
	raylib::Color color;
}

const float PLAYER_SPEED = 500.0;

fun void player_init(Player* player)
{
	// player.entity.type = EntityType::Player;
	player.color.r = 255; player.color.g = 255; player.color.b = 0; player.color.a = 255;
}

fun void player_update(Player* player)
{
	entity_update(&player.entity);

	var int dx = 0;
	var int dy = 0;

	if (raylib::IsKeyPressed(raylib::KeyboardKey::LEFT))
	{
		dx -= 1;
	}
	if (raylib::IsKeyPressed(raylib::KeyboardKey::RIGHT))
	{
		dx += 1;
	}
	if (raylib::IsKeyPressed(raylib::KeyboardKey::UP))
	{
		dy -= 1;
	}
	if (raylib::IsKeyPressed(raylib::KeyboardKey::DOWN))
	{
		dy += 1;
	}

	var int nx = player.entity.x + dx;
	var int ny = player.entity.y + dy;

	player.entity.x = nx;
	player.entity.y = ny;
}

fun void player_draw(Player* player)
{
	raylib::DrawRectangle(cast(int)(player.entity.visualX * cast(float)CELL_WIDTH), cast(int)(player.entity.visualY * cast(float)CELL_HEIGHT), CELL_WIDTH, CELL_WIDTH, player.color);

	// raylib::DrawText("pelly", player.entity.x - 8, player.entity.y - 24, 20, player.color);
	// raylib::DrawLine(cast(int)player.pos.x, cast(int)player.pos.y, raylib::GetMouseX(), raylib::GetMouseY(), player.color);
	//raylib::DrawCircle(raylib::GetMouseX(), raylib::GetMouseY(), 16, player.color);
}